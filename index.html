<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>EVO Roda Bertuah</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}

body{
  font-family:'Segoe UI',Arial,sans-serif;
  background:
    radial-gradient(circle at top, rgba(255,255,255,0.15), transparent 40%),
    linear-gradient(135deg,#6a11cb,#2575fc);
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:20px;
}

.container{
  background:rgba(255,255,255,0.96);
  border-radius:28px;
  padding:40px 28px 34px;
  width:100%;
  max-width:480px;
  box-shadow:
    0 30px 80px rgba(0,0,0,.35),
    inset 0 0 0 1px rgba(255,255,255,.4);
  text-align:center;
}

h1{
  font-size:28px;
  margin-bottom:10px;
  font-weight:800;
  color:#2d2d2d;
}

.subtitle{
  display:inline-block;
  font-size:13px;
  font-weight:600;
  background:linear-gradient(135deg,#ffe259,#ffa751);
  color:#5a3b00;
  padding:8px 18px;
  border-radius:999px;
  margin-bottom:26px;
  box-shadow:0 4px 10px rgba(0,0,0,.12);
}

input{
  width:100%;
  padding:16px 18px;
  font-size:16px;
  border-radius:14px;
  border:2px solid #ddd;
  margin-bottom:26px;
  outline:none;
  transition:.25s;
}

input:focus{
  border-color:#6a11cb;
  box-shadow:0 0 0 4px rgba(106,17,203,.15);
}

#wheel-container{
  position:relative;
  width:300px;
  height:300px;
  margin:0 auto 26px;
}

#wheel{
  width:100%;
  height:100%;
  border-radius:50%;
  border:10px solid #2d2d2d;
  box-shadow:
    0 20px 40px rgba(0,0,0,.35),
    inset 0 0 30px rgba(0,0,0,.15);
  transition:transform 4s cubic-bezier(.17,.67,.32,1.1);
}

.pointer{
  position:absolute;
  top:-18px;
  left:50%;
  transform:translateX(-50%);
  width:0;height:0;
  border-left:18px solid transparent;
  border-right:18px solid transparent;
  border-bottom:36px solid #ff3b3b;
  filter:drop-shadow(0 6px 8px rgba(0,0,0,.4));
  z-index:10;
}

.center{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  width:68px;height:68px;
  border-radius:50%;
  background:linear-gradient(135deg,#6a11cb,#2575fc);
  border:5px solid #fff;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:26px;
  box-shadow:0 8px 18px rgba(0,0,0,.4);
}

button{
  width:100%;
  padding:18px;
  font-size:18px;
  font-weight:800;
  border:none;
  border-radius:999px;
  background:linear-gradient(135deg,#6a11cb,#2575fc);
  color:#fff;
  cursor:pointer;
  letter-spacing:.5px;
  box-shadow:0 10px 25px rgba(106,17,203,.45);
  transition:.25s;
}

button:hover:not(:disabled){
  transform:translateY(-2px);
  box-shadow:0 14px 30px rgba(106,17,203,.55);
}

button:disabled{
  background:#aaa;
  box-shadow:none;
  cursor:not-allowed;
}

.footer{
  font-size:12px;
  color:#777;
  margin-top:20px;
  line-height:1.5;
}
</style>
</head>

<body>

<div class="container">
  <h1>üéâ EVO Roda Bertuah üéâ</h1>
  <div class="subtitle">Kedai Baharu ¬∑ Pasti ‚â• 1 Paket TR12 / CM</div>

  <input id="debtorCode" placeholder="Masukkan Kod Debtor" />

  <div id="wheel-container">
    <div class="pointer"></div>
    <canvas id="wheel" width="300" height="300"></canvas>
    <div class="center">üéÅ</div>
  </div>

  <button id="spinBtn">Putar Sekarang</button>

  <div class="footer">
    ‚Ä¢ Setiap Debtor hanya 1 kali<br>
    ‚Ä¢ Hadiah diberi bersama pesanan seterusnya
  </div>
</div>

<script>
const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
const spinBtn = document.getElementById("spinBtn");
const debtorInput = document.getElementById("debtorCode");

/* =========================
   UI Âå∫ÂùóÔºàÂøÖÈ°ªÂåÖÂê´ CTNÔºâ
========================= */
const rewards = [
  "TR12 / CM - 1 paket",
  "TR12 / CM - 2 paket",
  "TR12 / CM - 3 paket",
  "üéâ TR12 / CM - 1 CTN (10 paket)"
];

/* =========================
   ÂÆûÈôÖÊ¶ÇÁéáÔºà2% CTNÔºâ
========================= */
const probabilityPool = [
  { prize: rewards[0], weight: 75 },
  { prize: rewards[1], weight: 15 },
  { prize: rewards[2], weight: 8 },
  { prize: rewards[3], weight: 2 }
];

let currentRotation = 0;

/* ÁîªËΩ¨Áõò */
function drawWheel(){
  const arc = Math.PI*2/rewards.length;
  const colors=["#FFD966","#7FDBB6","#74B9FF","#FF7675"];

  rewards.forEach((text,i)=>{
    ctx.beginPath();
    ctx.fillStyle=colors[i];
    ctx.moveTo(150,150);
    ctx.arc(150,150,150,arc*i,arc*(i+1));
    ctx.fill();

    ctx.save();
    ctx.translate(150,150);
    ctx.rotate(arc*i+arc/2);
    ctx.textAlign="right";
    ctx.font="bold 13px Arial";
    ctx.fillStyle="#333";
    ctx.fillText(text,140,5);
    ctx.restore();
  });
}

/* Âä†ÊùÉÊäΩÂ•ñ */
function weightedRandom(){
  let total=probabilityPool.reduce((s,p)=>s+p.weight,0);
  let r=Math.random()*total;
  for(const p of probabilityPool){
    if(r<p.weight) return p.prize;
    r-=p.weight;
  }
}

spinBtn.onclick=()=>{
  const debtor=debtorInput.value.trim();
  if(!debtor){alert("ËØ∑ËæìÂÖ• Debtor Code");return;}

  const key="EVO_SPIN_"+debtor;
  if(localStorage.getItem(key)){
    alert("Debtor Â∑≤ÂèÇ‰∏éËøá üôè");
    return;
  }

  const result=weightedRandom();
  const index=rewards.indexOf(result);
  const arc=360/rewards.length;

  currentRotation +=
  360 * 5 +
  (360 - (index * arc + arc / 2)) +
  90 -
  arc / 2;
  canvas.style.transform=`rotate(${currentRotation}deg)`;

  spinBtn.disabled=true;
  spinBtn.textContent="Memutar...";
  localStorage.setItem(key,"played");

  setTimeout(()=>{
    fetch("https://script.google.com/macros/s/AKfycbyOEKmkjczMpTcBGUXBoVMrv5IuhAuNro4upiT85ueONZ6P2FXcp9zOJCeYCrOAcZi4/exec",{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify({
        debtor:debtor,
        reward:result,
        source:"EVO_WHEEL_TR12_CM"
      })
    });

    alert(
      "üéâ Tahniah!\n\n"+
      "Kod Debtor: "+debtor+
      "\n\nHadiah Anda:\n"+result+
      "\n\nHadiah akan diberi bersama pesanan seterusnya."
    );

    spinBtn.textContent="Sudah Menyertai";
  },4200);
};

drawWheel();
</script>

</body>
</html>



